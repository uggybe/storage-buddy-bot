# ‚úÖ –í—Å–µ –≥–æ—Ç–æ–≤–æ –∫ –∑–∞–ø—É—Å–∫—É!

## –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –ü–æ—Ä—è–¥–æ–∫ –º–∏–≥—Ä–∞—Ü–∏–π ‚úÖ
**–ü—Ä–æ–±–ª–µ–º–∞:** –°—Ç–∞—Ä—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ (2025-01) –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å –î–û —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü (2025-11-08), —á—Ç–æ –≤—ã–∑—ã–≤–∞–ª–æ –æ—à–∏–±–∫–∏:
```
ERROR: relation "public.items" does not exist
```

**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω—ã 4 –º–∏–≥—Ä–∞—Ü–∏–∏:
- `20250111_add_manufacturer_to_items.sql` ‚Üí `20251117000001_...`
- `20250111_add_name_fields_to_whitelist.sql` ‚Üí `20251117000002_...`
- `20250113_fix_cascade_delete_transactions.sql` ‚Üí `20251117000003_...`
- `20250113_add_performance_indexes.sql` ‚Üí `20251117000004_...`

–¢–µ–ø–µ—Ä—å –æ–Ω–∏ –≤—ã–ø–æ–ª–Ω—è—Ç—Å—è –ü–û–°–õ–ï —Å–æ–∑–¥–∞–Ω–∏—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü! ‚úÖ

### 2. PostgreSQL —Ä–æ–ª–∏ ‚úÖ
- –í—Å–µ 7 –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ä–æ–ª–µ–π –±—É–¥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- Init —Å–∫—Ä–∏–ø—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω (–±–∞–≥ —Å –ø–∞—Ä–æ–ª–µ–º authenticator)

### 3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ‚úÖ
- `.env` —Ñ–∞–π–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- Docker Compose –≥–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É
- Kong, Nginx, –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

---

## üöÄ –ß—Ç–æ –¥–µ–ª–∞—Ç—å —Å–µ–π—á–∞—Å

### –®–∞–≥ 1: –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–¥

```cmd
cd C:\bimbom\storage-buddy-bot
git pull
```

–≠—Ç–æ –ø–æ–¥—Ç—è–Ω–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏.

### –®–∞–≥ 2: –î–æ–±–∞–≤—å—Ç–µ Telegram Bot Token (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)

1. –û—Ç–∫—Ä–æ–π—Ç–µ `.env` –≤ –±–ª–æ–∫–Ω–æ—Ç–µ
2. –ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É:
   ```
   TELEGRAM_BOT_TOKEN=YOUR_TELEGRAM_BOT_TOKEN_HERE
   ```
3. –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à —Ä–µ–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω –æ—Ç @BotFather
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª

**–ë–µ–∑ —Ç–æ–∫–µ–Ω–∞ Telegram —Å–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç unhealthy!**

### –®–∞–≥ 3: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å —á–∏—Å—Ç–æ–π –±–∞–∑–æ–π

```cmd
docker compose down -v
docker compose up -d
```

–§–ª–∞–≥ `-v` —É–¥–∞–ª–∏—Ç —Å—Ç–∞—Ä—É—é –±–∞–∑—É —Å–æ —Å—Ç–∞—Ä—ã–º–∏ –æ—à–∏–±–∫–∞–º–∏ –º–∏–≥—Ä–∞—Ü–∏–π.

### –®–∞–≥ 4: –ü–æ–¥–æ–∂–¥–∏—Ç–µ 1-2 –º–∏–Ω—É—Ç—ã

–°–µ—Ä–≤–∏—Å—ã —Å—Ç–∞—Ä—Ç—É—é—Ç –Ω–µ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ. –ù–∞–±–ª—é–¥–∞–π—Ç–µ –∑–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–º:

```cmd
docker compose logs -f
```

–ù–∞–∂–º–∏—Ç–µ Ctrl+C —á—Ç–æ–±—ã –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤.

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å

```cmd
docker compose ps
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
NAME                     STATUS
storage-buddy-postgres   Up (healthy)     ‚úÖ
storage-buddy-kong       Up (healthy)     ‚úÖ
storage-buddy-auth       Up               ‚úÖ
storage-buddy-rest       Up               ‚úÖ
storage-buddy-storage    Up               ‚úÖ
storage-buddy-realtime   Up               ‚úÖ
storage-buddy-frontend   Up               ‚úÖ
storage-buddy-telegram   Up (healthy)     ‚úÖ
storage-buddy-imgproxy   Up               ‚úÖ
```

**–í—Å–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "Up"!** –ù–∏–∫–∞–∫–∏—Ö "(Restarting)" –∏–ª–∏ "(unhealthy)"*

*Telegram –º–æ–∂–µ—Ç –±—ã—Ç—å (unhealthy) –µ—Å–ª–∏ –Ω–µ –¥–æ–±–∞–≤–∏–ª–∏ —Ç–æ–∫–µ–Ω

---

## üåê –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±—Ä–∞—É–∑–µ—Ä –∏ –æ—Ç–∫—Ä–æ–π—Ç–µ:
```
http://localhost
```

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Storage Buddy Bot! üéâ

---

## üîç –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫

### Postgres unhealthy?
```cmd
docker compose logs postgres --tail 50
```
–ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫ "does not exist".

### Telegram unhealthy?
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –¥–æ–±–∞–≤–∏–ª–∏ —Ç–æ–∫–µ–Ω –≤ `.env` –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ:
```cmd
docker compose restart telegram-api
```

### Auth/Rest/Kong restarting?
–ó–Ω–∞—á–∏—Ç PostgreSQL —Ä–æ–ª–∏ –Ω–µ —Å–æ–∑–¥–∞–ª–∏—Å—å. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
```cmd
docker compose logs postgres | findstr "CREATE ROLE"
```
–î–æ–ª–∂–Ω–æ –±—ã—Ç—å 7 CREATE ROLE.

### –ü–æ—Ä—Ç 80 –∑–∞–Ω—è—Ç?
```cmd
netstat -ano | findstr :80
```
–ó–∞–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—Ä—Ç 80 (IIS, Skype, etc.)

---

## ‚ú® –ß—Ç–æ –¥–∞–ª—å—à–µ

1. **–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**: http://localhost
2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏**: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —Å–∫–ª–∞–¥—ã
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Telegram –±–æ—Ç–∞**: –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É /start
4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ backups** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): —Å–º. `scripts/backup-local.sh`
5. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ HTTPS** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): —Å–º. `MIGRATION.md`

---

## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –≤–∞—à–µ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

–ò–∑ –≤–∞—à–∏—Ö –ª–æ–≥–æ–≤ –≤–∏–¥–Ω–æ:
- ‚úÖ PostgreSQL: —Ä–∞–±–æ—Ç–∞–µ—Ç (healthy)
- ‚úÖ Kong: —Ä–∞–±–æ—Ç–∞–µ—Ç (healthy)
- ‚úÖ –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã: —Ä–∞–±–æ—Ç–∞—é—Ç (Up)
- ‚ö†Ô∏è Telegram: —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ unhealthy (–Ω—É–∂–µ–Ω —Ç–æ–∫–µ–Ω)
- ‚úÖ –†–µ—Å—É—Ä—Å—ã: –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ (3.6GB RAM, CPU < 5%)

**–ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ —Ç–æ–ª—å–∫–æ –≤ –ø–æ—Ä—è–¥–∫–µ –º–∏–≥—Ä–∞—Ü–∏–π** - —Ç–µ–ø–µ—Ä—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞! ‚úÖ

---

## üí° –í–∞–∂–Ω–æ –∑–Ω–∞—Ç—å

- **–í—Å–µ –¥–∞–Ω–Ω—ã–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ**: –Ω–∏—á–µ–≥–æ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ –æ–±–ª–∞–∫–æ
- **–ù–µ—Ç –º–µ—Å—è—á–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π**: Vercel –∏ Supabase –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω—ã
- **–ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å**: –≤—ã —É–ø—Ä–∞–≤–ª—è–µ—Ç–µ –≤—Å–µ–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
- **–ú–æ–∂–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å**: `docker compose down` (–¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è)
- **–ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å backup**: —Å–º. `scripts/backup-local.sh`

---

## üéä –ü–æ–∑–¥—Ä–∞–≤–ª—è—é!

–í—ã –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—É—é self-hosted –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É Storage Buddy Bot:

- PostgreSQL 15 (–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)
- Kong API Gateway
- GoTrue (–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è)
- PostgREST (REST API)
- Realtime (WebSockets)
- Storage API (—Ñ–∞–π–ª—ã)
- ImgProxy (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
- Nginx (–≤–µ–±-—Å–µ—Ä–≤–µ—Ä)
- Custom Telegram API service

**–í—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ!** üî•

---

–í—ã–ø–æ–ª–Ω–∏—Ç–µ 3 –∫–æ–º–∞–Ω–¥—ã –∏ –≥–æ—Ç–æ–≤–æ:
```cmd
git pull
[–¥–æ–±–∞–≤–∏—Ç—å —Ç–æ–∫–µ–Ω –≤ .env]
docker compose down -v && docker compose up -d
```

–ß–µ—Ä–µ–∑ 2 –º–∏–Ω—É—Ç—ã –≤—Å—ë –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç! üöÄ
